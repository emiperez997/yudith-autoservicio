---
import { ChevronLeft, ChevronRight } from "lucide-react";

interface Slide {
  image: string;
  title: string;
}

interface Props {
  slides: Slide[];
}

const { slides } = Astro.props;
---

<div class="relative w-full max-w-4xl mx-auto overflow-hidden md:rounded-xl">
  <!-- Slides -->
  <div class="flex transition-transform duration-500 ease-in-out" id="slider">
    {
      slides.map((slide, i) => (
        <div class="min-w-full">
          <img
            src={slide.image}
            alt={slide.title}
            class="w-full h-[420px] object-cover block"
          />
        </div>
      ))
    }
  </div>

  <!-- Flecha izquierda -->
  <button
    id="prev"
    aria-label="Anterior"
    class="absolute left-3 top-[50%] -translate-y-1/2 z-10 bg-white rounded-full w-10 h-10 flex items-center justify-center shadow-md text-2xl hover:bg-gray-100 transition"
  >
    <ChevronLeft className="h-6 w-6" />
  </button>

  <!-- Flecha derecha -->
  <button
    id="next"
    aria-label="Siguiente"
    class="absolute right-3 top-[50%] -translate-y-1/2 z-10 bg-white rounded-full w-10 h-10 flex items-center justify-center shadow-md text-2xl hover:bg-gray-100 transition"
  >
    <ChevronRight className="h-6 w-6" />
  </button>

  <!-- Dots -->
  <div class="flex justify-center items-center gap-2 py-4" id="dots">
    {
      slides.map((_, i) => (
        <span
          data-dot={i}
          class={`dot h-2.5 rounded-full cursor-pointer transition-all duration-300 ${
            i === 0 ? "w-6 bg-gray-800" : "w-2.5 bg-gray-300"
          }`}
        />
      ))
    }
  </div>
</div>

<script>
  const slider = document.getElementById("slider")!;
  const dots = document.querySelectorAll<HTMLElement>(".dot");
  const total = dots.length;
  let current = 0;

  function goTo(index: number) {
    current = (index + total) % total;
    slider.style.transform = `translateX(-${current * 100}%)`;

    dots.forEach((dot, i) => {
      if (i === current) {
        dot.classList.add("w-6", "bg-gray-800");
        dot.classList.remove("w-2.5", "bg-gray-300");
      } else {
        dot.classList.add("w-2.5", "bg-gray-300");
        dot.classList.remove("w-6", "bg-gray-800");
      }
    });
  }

  document
    .getElementById("prev")!
    .addEventListener("click", () => goTo(current - 1));
  document
    .getElementById("next")!
    .addEventListener("click", () => goTo(current + 1));
  dots.forEach((dot, i) => dot.addEventListener("click", () => goTo(i)));
</script>
